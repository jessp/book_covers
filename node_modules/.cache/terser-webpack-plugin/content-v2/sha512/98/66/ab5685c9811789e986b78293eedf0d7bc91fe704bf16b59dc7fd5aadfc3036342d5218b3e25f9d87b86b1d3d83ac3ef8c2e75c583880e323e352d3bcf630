{"code":"!function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,\"a\",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p=\"\",n(n.s=0)}([function(t,e,n){\"use strict\";function i(t){const e=magnifier.node().getContext(\"2d\");e.save();let n=width/gridColumns,i=height/gridRows,o=getMousePos(t),r=o.x/width*gridColumns,a=o.y/height*gridRows;magnifier.style(\"left\",o.x-150+\"px\"),magnifier.style(\"top\",o.y-150+\"px\");let l=data.filter(function(t){return!!t.grid_point&&(t.grid_point[0]>r-5&&t.grid_point[0]<r+5&&t.grid_point[1]>a-5&&t.grid_point[1]<a+5)});for(var d=0;d<l.length;d++){let t=l[d];if(largeImages[t.isbn13])e.drawImage(largeImages[t.isbn13],150-4*n+(r-t.grid_point[0])*n*6,150-4*i+(a-t.grid_point[1])*i*6,6*n,6*i);else{let o=new Image,l=t.book_image;o.src=l,o.onload=function(){largeImages[t.isbn13]=o},t.index<2500?e.drawImage(spriteSheets.one,20*t.index,0,20,30,150-4*n+(r-t.grid_point[0])*n*6,150-4*i+(a-t.grid_point[1])*i*6,6*n,6*i):e.drawImage(spriteSheets.two,20*(2500-t.index),0,20,30,150-4*n+(r-t.grid_point[0])*n*6,150-4*i+(a-t.grid_point[1])*i*6,6*n,6*i)}}e.restore()}n.r(e);let o,r,a,l,d,s,g,c=[],u=.6666667,f={},p={};function h(t,e,n){let i=new Image,o=t;i.src=o,i.onload=function(){f[e]=i,n()}}function m(){let t=a/o,e=l/r;g.save();for(var n=0;n<c.length;n++){const i=c[n];g.fillStyle=d3.hsl(i.hue/2,i.saturation/255,i.value/255),i.grid_point&&(n<2500?g.drawImage(f.one,20*n,0,20,30,i.grid_point[0]*t,i.grid_point[1]*e,t,e):g.drawImage(f.two,20*(n-2500),0,20,30,i.grid_point[0]*t,i.grid_point[1]*e,t,e))}g.restore()}window.onload=function(t){console.log(i),a=d3.select(\".main\").node().getBoundingClientRect().width,l=d3.select(\".main\").node().getBoundingClientRect().height,(d=d3.select(\".main\").select(\"#mainCanvas\")).attr(\"width\",a),d.attr(\"height\",l),(s=d3.select(\".main\").select(\"#magnifier\")).attr(\"width\",300),s.attr(\"height\",300),g=d.node().getContext(\"2d\"),d3.json(\"./../data/full_json_output.json\").then(function(t){function e(){!function(t,e,n){let i=e/t*u;r=Math.ceil(Math.sqrt(i*n)),function(t,e,n){var i=!1;try{i=new XMLHttpRequest}catch(t){try{i=new ActiveXObject(\"Msxml2.XMLHTTP\")}catch(t){try{i=new ActiveXObject(\"Microsoft.XMLHTTP\")}catch(t){return console.log(t),!1}}}i.open(\"POST\",t,!0),i.onreadystatechange=function(){4==i.readyState&&n(i)},i.send(e)}(\"http://localhost:8070\",[o=Math.ceil(Math.sqrt(n/i)),r],function(t){c=JSON.parse(t.responseText),m()})}(a,l,t.length),function(){for(var t=0;t<c.length;t++){let e=c[t];if(e.grid_point&&!p[e.isbn13]){let t=new Image,n=e.book_image;t.src=n,t.onload=function(){p[e.isbn13]=t}}}}()}h(\"./../images/sprite_sheet_1.jpg\",\"one\",()=>h(\"./../images/sprite_sheet_2.jpg\",\"two\",e))})}}]);","extractedComments":[]}